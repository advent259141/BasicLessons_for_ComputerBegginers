<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capstone Project: Minecraft Computer Science</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts: Pixel Font -->
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #1a1a1a;
            font-family: 'VT323', monospace;
            background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://www.transparenttextures.com/patterns/dark-dirt.png');
        }
        
        /* Minecraft Button Style */
        .mc-btn {
            background-color: #7d7d7d;
            border-top: 2px solid #a8a8a8;
            border-left: 2px solid #a8a8a8;
            border-bottom: 2px solid #3b3b3b;
            border-right: 2px solid #3b3b3b;
            color: #fff;
            text-shadow: 2px 2px #000;
            transition: all 0.1s;
            cursor: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB9JREFUOE9jZKAQMFKon2HUAIbR4AAwGg0DmAQGBAAA6bgA517g62oAAAAASUVORK5CYII='), pointer;
        }
        .mc-btn:active {
            border-top: 2px solid #3b3b3b;
            border-left: 2px solid #3b3b3b;
            border-bottom: 2px solid #a8a8a8;
            border-right: 2px solid #a8a8a8;
            background-color: #595959;
        }
        .mc-btn:disabled {
            color: #a0a0a0;
            cursor: not-allowed;
        }

        /* Minecraft Input Style */
        .mc-input {
            background-color: #000;
            border: 2px solid #a0a0a0;
            color: #fff;
            font-family: 'VT323', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #555; border: 2px solid #1a1a1a; }

        /* Animations */
        @keyframes mine {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(-45deg); }
            100% { transform: rotate(0deg); }
        }
        .mining-animation { animation: mine 0.3s ease-in-out; }

        @keyframes packet-travel {
            0% { left: 10%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { left: 90%; opacity: 0; }
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen flex flex-col">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Shared Icons ---
        const Icon = ({ name, size = 24, className }) => {
            const icons = {
                Server: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="8" x="2" y="2" rx="2" ry="2"/><rect width="20" height="8" x="2" y="14" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></svg>,
                Network: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="16" y="16" width="6" height="6" rx="1"/><rect x="2" y="16" width="6" height="6" rx="1"/><rect x="9" y="2" width="6" height="6" rx="1"/><path d="M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"/><path d="M12 12V8"/></svg>,
                Cpu: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></svg>,
                Code: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>,
                Pickaxe: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>,
                Zap: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
                Monitor: <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="14" x="2" y="3" rx="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/></svg>
            };
            return icons[name] || null;
        };

        // --- Component 1: Server Configurator (Hardware/OS) ---
        const ServerConfig = () => {
            const [ram, setRam] = useState(4);
            const [consoleLogs, setConsoleLogs] = useState([
                "> æ­£åœ¨åˆå§‹åŒ–ç³»ç»Ÿ...",
                "> æ£€æµ‹åˆ° Java 17 (64-bit)",
                "> ç­‰å¾…ç”¨æˆ·æŒ‡ä»¤..."
            ]);
            const [serverState, setServerState] = useState('OFFLINE'); // OFFLINE, STARTING, RUNNING, CRASHED

            const startServer = () => {
                if(serverState !== 'OFFLINE') return;
                
                setServerState('STARTING');
                setConsoleLogs([]);
                
                const steps = [
                    `> æ‰§è¡Œå¯åŠ¨è„šæœ¬: java -Xmx${ram}G -Xms${ram}G -jar server.jar`,
                    "> åŠ è½½ libraries, please wait...",
                    "> [INFO] Environment: Windows 10 (10.0)",
                ];

                // Simulation Logic
                if (ram < 2) {
                    steps.push("> [ERROR] OutOfMemoryError: Java heap space");
                    steps.push("> [CRITICAL] å†…å­˜ä¸è¶³ä»¥åŠ è½½ Spawn åŒºåŸŸ");
                    steps.push("> è¿›ç¨‹ä»¥ä»£ç  1 é€€å‡º (Crash)");
                    animateLogs(steps, 'CRASHED');
                } else if (ram > 16) {
                    steps.push("> [WARN] åˆ†é…å†…å­˜è¶…è¿‡ç‰©ç†å†…å­˜é™åˆ¶");
                    steps.push("> [WARN] ç³»ç»Ÿå¼€å§‹ä½¿ç”¨è™šæ‹Ÿå†…å­˜ (Swap)");
                    steps.push("> [INFO] Server thread/WARN: Can't keep up! Is the server overloaded?");
                    steps.push("> TPS (Ticks Per Second): 5.2 (Laggy)");
                    animateLogs(steps, 'RUNNING');
                } else {
                    steps.push("> [INFO] Loading properties...");
                    steps.push("> [INFO] Default game type: SURVIVAL");
                    steps.push("> [INFO] Generating keypair");
                    steps.push("> [INFO] Starting Minecraft server on *:25565");
                    steps.push(`> [INFO] Done (${(Math.random() * 5 + 2).toFixed(3)}s)! For help, type "help"`);
                    animateLogs(steps, 'RUNNING');
                }
            };

            const animateLogs = (logs, finalState) => {
                let i = 0;
                const timer = setInterval(() => {
                    if (i < logs.length) {
                        const currentLog = logs[i];
                        if (currentLog) {
                            setConsoleLogs(prev => [...prev, currentLog]);
                        }
                        i++;
                    } else {
                        clearInterval(timer);
                        setServerState(finalState);
                    }
                }, 600);
            };

            return (
                <div className="grid md:grid-cols-2 gap-8 p-4">
                    {/* Control Panel */}
                    <div className="space-y-6">
                        <div className="bg-[#c6c6c6] p-1 border-4 border-[#555] shadow-xl">
                            <div className="bg-[#8b8b8b] p-4 border-2 border-[#fff] border-r-[#555] border-b-[#555]">
                                <h3 className="text-2xl font-bold mb-4 text-white drop-shadow-md">Server.properties</h3>
                                
                                <div className="mb-6">
                                    <label className="block text-lg mb-2 text-white">åˆ†é…å†…å­˜ (RAM): <span className="text-yellow-300">{ram} GB</span></label>
                                    <input 
                                        type="range" min="1" max="24" step="1" 
                                        value={ram} onChange={(e) => setRam(parseInt(e.target.value))}
                                        className="w-full h-4 bg-black appearance-none border-2 border-gray-500 outline-none opacity-90 hover:opacity-100 cursor-pointer"
                                    />
                                    <div className="flex justify-between text-sm mt-1 text-gray-200 font-mono">
                                        <span>1GB (OOM)</span>
                                        <span>4-8GB (æœ€ä½³)</span>
                                        <span>24GB (æµªè´¹/å¡é¡¿)</span>
                                    </div>
                                </div>

                                <div className="space-y-2 text-sm font-mono text-gray-200">
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 bg-green-500 border border-white"></div>
                                        <span>CPU: Intel Core i9 (å•æ ¸å¼ºåŠ²)</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 bg-blue-500 border border-white"></div>
                                        <span>Java: OpenJDK 17 HotSpot</span>
                                    </div>
                                </div>

                                <button 
                                    onClick={startServer} 
                                    disabled={serverState === 'STARTING'}
                                    className="mc-btn w-full py-3 text-xl font-bold mt-6"
                                >
                                    {serverState === 'STARTING' ? 'å¯åŠ¨ä¸­...' : serverState === 'RUNNING' ? 'é‡å¯æœåŠ¡å™¨' : 'å¯åŠ¨æœåŠ¡å™¨'}
                                </button>
                            </div>
                        </div>
                        
                        <div className="bg-black/30 p-4 rounded border border-gray-600 text-sm text-gray-300">
                            <h4 className="text-yellow-400 font-bold mb-2">ğŸ“– çŸ¥è¯†ç‚¹å›é¡¾ï¼š</h4>
                            <ul className="list-disc pl-4 space-y-1">
                                <li><strong>Heap Space (å †å†…å­˜)</strong>: Java ç¨‹åºè¿è¡Œéœ€è¦é¢„å…ˆåˆ†é…å†…å­˜æ± ã€‚åˆ†é…å¤ªå°‘ä¼šæº¢å‡º(OOM)ï¼Œåˆ†é…å¤ªå¤šä¼šå¯¼è‡´åƒåœ¾å›æ”¶(GC)æ—¶é—´è¿‡é•¿ï¼Œå¼•èµ·å¡é¡¿ã€‚</li>
                                <li><strong>å•æ ¸æ€§èƒ½</strong>: Minecraft ä¸»çº¿ç¨‹æå…¶ç¹é‡ï¼Œ"å¤šæ ¸æ´‹åƒåœ¾"CPU ä¸å¦‚"é«˜é¢‘å•æ ¸"CPUã€‚</li>
                            </ul>
                        </div>
                    </div>

                    {/* Console Output */}
                    <div className="bg-black border-4 border-[#555] p-4 font-mono text-sm text-gray-300 h-[400px] overflow-y-auto shadow-inner flex flex-col">
                        <div className="border-b border-gray-700 pb-2 mb-2 text-gray-500">root@minecraft-server:~# ./start.sh</div>
                        <div className="flex-1 space-y-1">
                            {consoleLogs.map((log, i) => (
                                <div key={i} className={`${(log && (log.includes('ERROR') || log.includes('CRITICAL'))) ? 'text-red-500' : (log && log.includes('WARN')) ? 'text-yellow-500' : 'text-gray-300'}`}>
                                    {log}
                                </div>
                            ))}
                            <div className="animate-pulse">_</div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Component 2: Network Visualizer (NAT/Port Forwarding) ---
        const NetworkSim = () => {
            const [firewall, setFirewall] = useState(true); // true = block
            const [portMapping, setPortMapping] = useState(false); // true = mapped
            const [packetStatus, setPacketStatus] = useState('idle'); // idle, traveling, blocked_fw, blocked_nat, success

            const sendPacket = () => {
                if (packetStatus !== 'idle') return;
                setPacketStatus('traveling');

                setTimeout(() => {
                    // Check Firewall
                    if (firewall) {
                        setPacketStatus('blocked_fw');
                        setTimeout(() => setPacketStatus('idle'), 2000);
                        return;
                    }
                    
                    // Travel through internet...
                    setTimeout(() => {
                        // Check NAT
                        if (!portMapping) {
                            setPacketStatus('blocked_nat');
                            setTimeout(() => setPacketStatus('idle'), 2000);
                            return;
                        }

                        // Success
                        setPacketStatus('success');
                        setTimeout(() => setPacketStatus('idle'), 3000);

                    }, 1500);
                }, 1500);
            };

            return (
                <div className="p-4 space-y-8">
                    {/* Network Diagram */}
                    <div className="relative h-48 bg-black/20 rounded-xl border border-gray-700 flex items-center justify-between px-8 md:px-20 overflow-hidden">
                        
                        {/* Friend */}
                        <div className="relative z-10 flex flex-col items-center">
                            <div className="w-16 h-16 bg-blue-600 border-4 border-white rounded-lg flex items-center justify-center text-3xl">ğŸ˜ƒ</div>
                            <div className="mt-2 text-center">
                                <div className="font-bold">åŸºå‹</div>
                                <div className="text-xs text-gray-400">Public IP</div>
                            </div>
                        </div>

                        {/* Router/Firewall */}
                        <div className="relative z-10 flex flex-col items-center">
                            <div className={`w-20 h-20 border-4 flex items-center justify-center text-3xl transition-colors duration-300 ${portMapping ? 'bg-green-900 border-green-500' : 'bg-red-900 border-red-500'}`}>
                                <Icon name="Network" size={32} />
                            </div>
                            <div className="mt-2 text-center">
                                <div className="font-bold">è·¯ç”±å™¨ (NAT)</div>
                                <div className="text-xs text-gray-400">Port 25565</div>
                            </div>
                            {/* Firewall Shield */}
                            <div className={`absolute -top-8 transition-all duration-300 ${firewall ? 'opacity-100 scale-100' : 'opacity-20 scale-75'}`}>
                                <div className="bg-red-600 text-white text-xs font-bold px-2 py-1 rounded border-2 border-white">é˜²ç«å¢™æ‹¦æˆª</div>
                            </div>
                        </div>

                        {/* Your Server */}
                        <div className="relative z-10 flex flex-col items-center">
                            <div className="w-16 h-16 bg-stone-700 border-4 border-white rounded-lg flex items-center justify-center text-3xl">ğŸ–¥ï¸</div>
                            <div className="mt-2 text-center">
                                <div className="font-bold">ä½ çš„ç”µè„‘</div>
                                <div className="text-xs text-gray-400">192.168.x.x</div>
                            </div>
                        </div>

                        {/* Connecting Line */}
                        <div className="absolute top-1/2 left-0 w-full h-1 bg-gray-600 -z-0"></div>

                        {/* Packet Animation */}
                        {packetStatus !== 'idle' && (
                            <div 
                                className={`absolute top-1/2 -mt-3 w-6 h-6 bg-yellow-400 border-2 border-white rounded-sm z-20 transition-all duration-[3000ms] linear
                                    ${packetStatus === 'traveling' ? 'left-[10%]' : ''}
                                `}
                                style={{
                                    left: packetStatus === 'traveling' ? '15%' : 
                                          packetStatus === 'blocked_fw' ? '45%' : 
                                          packetStatus === 'blocked_nat' ? '50%' : 
                                          packetStatus === 'success' ? '85%' : '15%',
                                    opacity: packetStatus === 'success' ? 0 : 1,
                                    transition: 'left 1.5s linear, opacity 0.5s'
                                }}
                            ></div>
                        )}

                        {/* Status Messages */}
                        {packetStatus === 'blocked_fw' && <div className="absolute top-10 left-1/2 -translate-x-1/2 text-red-500 font-bold animate-bounce">è¢« Windows é˜²ç«å¢™æ‹¦æˆª!</div>}
                        {packetStatus === 'blocked_nat' && <div className="absolute top-10 left-1/2 -translate-x-1/2 text-yellow-500 font-bold animate-bounce">ç«¯å£æœªæ˜ å°„ï¼Œè·¯ç”±å™¨ä¸çŸ¥é“ç»™è°!</div>}
                        {packetStatus === 'success' && <div className="absolute top-10 left-1/2 -translate-x-1/2 text-green-500 font-bold animate-bounce">è¿æ¥æˆåŠŸ! Player Joined.</div>}

                    </div>

                    {/* Controls */}
                    <div className="grid md:grid-cols-2 gap-8">
                        <div className="bg-[#c6c6c6] p-4 border-4 border-[#555] text-black">
                            <h4 className="font-bold text-lg mb-4">è·¯ç”±å™¨åå° / ç³»ç»Ÿè®¾ç½®</h4>
                            
                            <div className="flex items-center justify-between mb-4 p-2 bg-white border-2 border-gray-400">
                                <span>Windows é˜²ç«å¢™ (Java)</span>
                                <button 
                                    onClick={() => setFirewall(!firewall)}
                                    className={`px-3 py-1 font-bold border-2 border-black ${firewall ? 'bg-red-500 text-white' : 'bg-green-500 text-white'}`}
                                >
                                    {firewall ? "é˜»æ–­ (Block)" : "å…è®¸ (Allow)"}
                                </button>
                            </div>

                            <div className="flex items-center justify-between p-2 bg-white border-2 border-gray-400">
                                <div>
                                    <div>ç«¯å£æ˜ å°„ (Port Forwarding)</div>
                                    <div className="text-xs text-gray-500">Ext: 25565 -> Int: 25565</div>
                                </div>
                                <button 
                                    onClick={() => setPortMapping(!portMapping)}
                                    className={`px-3 py-1 font-bold border-2 border-black ${!portMapping ? 'bg-gray-300 text-gray-600' : 'bg-green-500 text-white'}`}
                                >
                                    {!portMapping ? "æœªé…ç½®" : "å·²å¯ç”¨"}
                                </button>
                            </div>
                        </div>

                        <div className="flex flex-col justify-center items-center gap-4">
                            <p className="text-center text-gray-400">é…ç½®å¥½ç½‘ç»œåï¼Œè®©åŸºå‹å°è¯•è¿æ¥</p>
                            <button onClick={sendPacket} disabled={packetStatus !== 'idle'} className="mc-btn text-xl py-4 px-12 w-full md:w-auto">
                                å‘èµ·è¿æ¥è¯·æ±‚ (TCP Handshake)
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Component 3: C/S Architecture Demo (The "Ghost Block") ---
        const ClientServerDemo = () => {
            const [latency, setLatency] = useState(50); 
            const [packetLoss, setPacketLoss] = useState(false); 
            
            // State: 0=Exist, 1=Client Broken(Predicted), 2=Server Confirmed Broken
            const [clientBlock, setClientBlock] = useState(0);
            const [serverBlock, setServerBlock] = useState(0);
            
            const [logs, setLogs] = useState([]);
            const [isProcessing, setIsProcessing] = useState(false);

            const addLog = (source, msg) => {
                setLogs(prev => [...prev.slice(-5), { source, msg, id: Date.now() }]);
            };

            const mineBlock = () => {
                if (isProcessing || serverBlock === 2) return;
                setIsProcessing(true);

                // 1. Client-side Prediction
                setClientBlock(1);
                addLog('Client', 'ç©å®¶ç‚¹å‡»æŒ–æ˜ -> æ‰§è¡Œæœ¬åœ°é¢„æµ‹ç§»é™¤ (Predict)');

                // Simulate Network Travel
                setTimeout(() => {
                    if (packetLoss) {
                        // Loss Scenario
                        addLog('Network', 'âŒ æ•°æ®åŒ…ä¸¢å¤±æˆ–è¶…æ—¶ï¼');
                        
                        setTimeout(() => {
                            addLog('Server', 'åŒæ­¥ä¸–ç•ŒçŠ¶æ€ -> å‘ŠçŸ¥å®¢æˆ·ç«¯æ–¹å—å­˜åœ¨');
                            setClientBlock(0); // Ghost Block Reappears!
                            addLog('Client', 'æ”¶åˆ°æœåŠ¡å™¨çº æ­£ -> æ–¹å—å¼¹å› (Ghost Block)');
                            setIsProcessing(false);
                        }, latency);
                    } else {
                        // Success Scenario
                        addLog('Server', 'æ”¶åˆ°æŒ–æ˜è¯·æ±‚ -> éªŒè¯åˆæ³•æ€§ -> ç¡®è®¤ç ´å');
                        setServerBlock(2); 
                        
                        setTimeout(() => {
                            addLog('Client', 'æ”¶åˆ°æœåŠ¡å™¨ç¡®è®¤ (ACK) -> åŒæ­¥å®Œæˆ');
                            setClientBlock(2); 
                            setIsProcessing(false);
                        }, latency);
                    }
                }, latency);
            };

            const reset = () => {
                setClientBlock(0);
                setServerBlock(0);
                setLogs([]);
                setIsProcessing(false);
            };

            return (
                <div className="space-y-6 p-4">
                    <div className="flex flex-col md:flex-row justify-between items-center border-b border-gray-700 pb-4 gap-4">
                        <h3 className="text-2xl font-bold text-white flex items-center gap-2">
                            <Icon name="Zap" className="text-yellow-400" /> 
                            ä¸¤ä¸ªä¸–ç•Œçš„çœŸç›¸
                        </h3>
                        <div className="flex gap-6 text-lg bg-black/40 p-2 rounded border border-gray-600">
                            <label className="flex items-center gap-2 text-gray-300">
                                å»¶è¿Ÿ (Ping):
                                <input 
                                    type="range" min="50" max="2000" step="50" 
                                    value={latency} onChange={(e) => setLatency(Number(e.target.value))}
                                    className="accent-blue-500 w-32"
                                />
                                <span className="font-mono w-16 text-right">{latency}ms</span>
                            </label>
                            <label className="flex items-center gap-2 text-gray-300 cursor-pointer hover:text-white">
                                <input 
                                    type="checkbox" 
                                    checked={packetLoss} 
                                    onChange={(e) => setPacketLoss(e.target.checked)}
                                    className="w-5 h-5 rounded accent-red-500"
                                />
                                <span className={packetLoss ? "text-red-400 font-bold" : ""}>æ¨¡æ‹Ÿæ‰çº¿/ä¸¢åŒ…</span>
                            </label>
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4 md:gap-12 relative min-h-[300px]">
                        {/* Connection Line */}
                        <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full md:w-1/2 border-t-4 border-dashed border-gray-600 -z-10"></div>
                        <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-8 bg-black px-2 text-gray-500 text-xs">Network Layer</div>
                        
                        {/* Client View */}
                        <div className="bg-[#3a3a3a] rounded-xl border-4 border-[#222] p-6 relative shadow-2xl flex flex-col items-center">
                            <div className="absolute -top-4 left-4 bg-blue-600 text-white text-sm px-3 py-1 border-2 border-white font-bold">Client (ç©å®¶è§†è§’)</div>
                            <div className="flex-1 flex items-center justify-center w-full h-48 relative">
                                {/* The Block */}
                                <div 
                                    onClick={mineBlock}
                                    className={`w-24 h-24 cursor-pointer transition-all duration-100 relative group
                                        ${clientBlock === 0 ? 'opacity-100 scale-100' : 
                                          clientBlock === 1 ? 'opacity-20 scale-90' : 'opacity-0 scale-0'}
                                    `}
                                >
                                    {/* Dirt Texture Simulation */}
                                    <div className="w-full h-full bg-[#5d4037] border-4 border-[#3e2723] relative shadow-lg hover:brightness-110 active:scale-95 flex items-center justify-center">
                                        <div className="w-full h-1/3 bg-[#388e3c] absolute top-0 left-0 border-b-4 border-[#1b5e20]"></div>
                                        <span className="relative z-10 font-bold text-[#8d6e63] text-xl drop-shadow-md">DIRT</span>
                                    </div>
                                </div>
                                {clientBlock === 0 && (
                                    <div className="absolute bottom-4 text-sm text-gray-400 animate-bounce">ğŸ‘‡ ç‚¹å‡»æŒ–æ˜</div>
                                )}
                            </div>
                            <div className="w-full bg-black p-2 text-xs text-center font-mono text-gray-300 border-t-2 border-[#222]">
                                State: {clientBlock === 0 ? "EXIST" : clientBlock === 1 ? "PREDICTED_AIR" : "AIR"}
                            </div>
                        </div>

                        {/* Server View */}
                        <div className="bg-[#2b2b2b] rounded-xl border-4 border-[#222] p-6 relative shadow-2xl flex flex-col items-center">
                            <div className="absolute -top-4 right-4 bg-green-600 text-white text-sm px-3 py-1 border-2 border-white font-bold">Server (ä¸Šå¸è§†è§’)</div>
                            <div className="flex-1 flex items-center justify-center w-full h-48">
                                <div className={`w-24 h-24 transition-all duration-500 ${serverBlock === 0 ? 'opacity-100' : 'opacity-0'}`}>
                                    <div className="w-full h-full bg-[#5d4037] border-4 border-[#3e2723] opacity-50 grayscale flex items-center justify-center">
                                        <span className="font-bold text-white text-xl">DATA</span>
                                    </div>
                                </div>
                            </div>
                            <div className="w-full bg-black p-2 text-xs text-center font-mono text-gray-300 border-t-2 border-[#222]">
                                Authority: {serverBlock === 0 ? "TRUE" : "FALSE"}
                            </div>
                        </div>
                    </div>

                    {/* Logs */}
                    <div className="bg-black/80 border-2 border-gray-600 p-4 rounded h-40 overflow-hidden flex flex-col justify-end font-mono text-sm shadow-inner">
                        {logs.map((l) => (
                            <div key={l.id} className="animate-[packet-travel_0.2s_ease-out] flex">
                                <span className="text-gray-500 mr-2">[{new Date(l.id).toLocaleTimeString()}]</span>
                                <span className={`font-bold mr-2 ${
                                    l.source === 'Client' ? 'text-blue-400' : 
                                    l.source === 'Server' ? 'text-green-400' : 
                                    l.source === 'Network' ? 'text-red-500' : 'text-yellow-400'
                                }`}>
                                    {l.source}:
                                </span>
                                <span className="text-gray-300">{l.msg}</span>
                            </div>
                        ))}
                        {logs.length === 0 && <span className="text-gray-600 italic">// ç³»ç»Ÿå°±ç»ªã€‚è¯·å°è¯•ç‚¹å‡»å·¦ä¾§æ–¹å—ã€‚å°è¯•å‹¾é€‰â€œæ¨¡æ‹Ÿæ‰çº¿â€æ¥è§¦å‘å¹½çµæ–¹å—ã€‚</span>}
                    </div>

                    <div className="flex justify-end">
                        <button onClick={reset} className="mc-btn px-6 py-2">é‡ç½®å®éªŒ</button>
                    </div>
                </div>
            );
        };

        // --- Component 4: Client Rendering (Graphics) ---
        const ClientRendering = () => {
            const [culling, setCulling] = useState(true);
            const [rotation, setRotation] = useState(0);
            
            // Auto rotate
            useEffect(() => {
                const interval = setInterval(() => {
                    setRotation(r => (r + 2) % 360);
                }, 50);
                return () => clearInterval(interval);
            }, []);

            const gridSize = 7; // 7x7 grid of chunks
            const center = Math.floor(gridSize / 2);
            
            const chunks = [];
            let renderedCount = 0;

            for (let y = 0; y < gridSize; y++) {
                for (let x = 0; x < gridSize; x++) {
                    const dx = x - center;
                    const dy = y - center;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    
                    // Calculate angle relative to center
                    let angle = Math.atan2(dy, dx) * (180 / Math.PI); // -180 to 180
                    // Adjust angle to be 0-360 based on typical circle coordinates (0 is right, 90 is down)
                    // We want 0 to be up for easier mental model, but let's stick to standard math.
                    // Let's normalize angle to 0-360
                    let normAngle = angle + 90; // Rotate so 0 is Up
                    if (normAngle < 0) normAngle += 360;
                    if (normAngle >= 360) normAngle -= 360;

                    // Check difference from rotation
                    let diff = Math.abs(normAngle - rotation);
                    if (diff > 180) diff = 360 - diff;
                    
                    // Is Visible Logic:
                    // 1. Distance Check (Render Distance)
                    // 2. Angle Check (FOV ~90 degrees) OR very close (always visible)
                    const isVisible = dist <= 3 && (diff < 45 || dist < 0.8); 
                    
                    // Is Rendered Logic:
                    // If culling is ON, only render visible.
                    // If culling is OFF, render EVERYTHING loaded.
                    const isRendered = !culling || isVisible;
                    
                    if (isRendered) renderedCount++;

                    chunks.push({ x, y, isRendered, isVisible });
                }
            }

            // Simulation Stats
            const fps = culling ? 120 : 15; 
            const gpuLoad = culling ? 30 : 99;

            return (
                <div className="p-4 space-y-6">
                    <div className="flex justify-between items-center border-b border-gray-700 pb-4">
                        <h3 className="text-2xl font-bold text-white flex items-center gap-2">
                            <Icon name="Monitor" className="text-purple-400" /> 
                            æœ¬åœ°æ¸²æŸ“ç®¡çº¿
                        </h3>
                        <div className="flex gap-4">
                            <div className="bg-black/40 p-2 rounded border border-gray-600 font-mono text-sm">
                                <div className={fps > 60 ? "text-green-400" : "text-red-500"}>FPS: {fps}</div>
                                <div className="text-gray-400">GPU Load: {gpuLoad}%</div>
                            </div>
                        </div>
                    </div>

                    <div className="grid md:grid-cols-2 gap-8">
                        {/* Visualization */}
                        <div className="bg-black rounded-xl border-4 border-[#222] p-4 relative aspect-square flex items-center justify-center overflow-hidden">
                            <div className="absolute top-2 left-2 text-xs text-gray-500">Top-down View (Chunk Map)</div>
                            
                            <div className="grid grid-cols-7 gap-1 w-full h-full">
                                {chunks.map((chunk, i) => (
                                    <div 
                                        key={i}
                                        className={`
                                            rounded-sm transition-colors duration-75 flex items-center justify-center text-[8px] text-black/50 font-bold
                                            ${chunk.x === center && chunk.y === center ? 'bg-white z-10' : 
                                              chunk.isRendered ? (chunk.isVisible ? 'bg-green-500' : 'bg-red-500') : 'bg-gray-800'}
                                        `}
                                    >
                                        {chunk.x === center && chunk.y === center ? 'YOU' : chunk.isRendered ? 'DRAW' : ''}
                                    </div>
                                ))}
                            </div>
                            
                            {/* Cone overlay visual helper */}
                            <div 
                                className="absolute top-1/2 left-1/2 w-[150%] h-[150%] pointer-events-none opacity-20 bg-gradient-to-b from-transparent via-white to-transparent"
                                style={{
                                    transformOrigin: 'center',
                                    transform: `translate(-50%, -50%) rotate(${rotation}deg)`,
                                    clipPath: 'polygon(50% 50%, 0% 0%, 100% 0%)' // Triangle facing up
                                }}
                            ></div>
                        </div>

                        {/* Controls & Explanation */}
                        <div className="space-y-6">
                            <div className="bg-[#c6c6c6] p-4 border-4 border-[#555] text-black">
                                <h4 className="font-bold text-lg mb-4">æ˜¾å¡æ§åˆ¶é¢æ¿</h4>
                                
                                <div className="flex items-center justify-between p-2 bg-white border-2 border-gray-400 mb-2">
                                    <div>
                                        <div>è§†é”¥å‰”é™¤ (Frustum Culling)</div>
                                        <div className="text-xs text-gray-500">åªæ¸²æŸ“è§†é‡å†…çš„ç‰©ä½“</div>
                                    </div>
                                    <button 
                                        onClick={() => setCulling(!culling)}
                                        className={`px-3 py-1 font-bold border-2 border-black ${!culling ? 'bg-gray-300 text-gray-600' : 'bg-green-500 text-white'}`}
                                    >
                                        {culling ? "ON" : "OFF"}
                                    </button>
                                </div>
                                
                                <div className="text-xs mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded">
                                    <strong>è§‚å¯Ÿå·¦å›¾ï¼š</strong>
                                    <ul className="list-disc pl-4 mt-1">
                                        <li><span className="text-green-600 font-bold">ç»¿è‰²</span>: è§†é‡å†…ï¼ŒGPU æ­£åœ¨å…¨åŠ›æ¸²æŸ“ã€‚</li>
                                        <li><span className="text-red-500 font-bold">çº¢è‰²</span>: è§†é‡å¤–ï¼Œä½†åœ¨åŠ è½½èŒƒå›´å†…ã€‚å¦‚æœå…³é—­å‰”é™¤ï¼ŒGPU å°±è¦ç™½ç™½æ¸²æŸ“è¿™äº›çœ‹ä¸è§çš„ä¸œè¥¿ï¼Œå¯¼è‡´ FPS æš´è·Œã€‚</li>
                                        <li><span className="text-gray-600 font-bold">ç°è‰²</span>: è¢«å‰”é™¤ï¼ŒGPU å¿½ç•¥ï¼ŒèŠ‚çœç®—åŠ›ã€‚</li>
                                    </ul>
                                </div>
                            </div>

                            <div className="bg-slate-900 p-4 rounded border border-purple-500/30">
                                <h4 className="text-purple-400 font-bold mb-2 flex items-center gap-2">
                                    <Icon name="Code" size={16}/> æ¸²æŸ“ç®¡çº¿ (Pipeline)
                                </h4>
                                <div className="space-y-2 text-xs font-mono text-gray-300">
                                    <div className="flex items-center gap-2">
                                        <span className="text-blue-400">1. CPU:</span> 
                                        <span>è·å–æ–¹å—æ•°æ® (BlockPos: 10, 64, 10, ID: Stone)</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <span className="text-yellow-400">2. Cull:</span> 
                                        <span>æ£€æŸ¥æ˜¯å¦åœ¨è§†é‡å†…ï¼Ÿ{culling ? "YES -> Pass" : "Skip Check -> Pass"}</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <span className="text-green-400">3. GPU:</span> 
                                        <span>å°†é¡¶ç‚¹ (Vertices) è½¬æ¢ä¸ºåƒç´  (Rasterization)</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <span className="text-pink-400">4. Screen:</span> 
                                        <span>è¾“å‡ºç”»é¢ (Frame)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Component 5: Redstone Logic (Programming) ---
        const RedstoneLogic = () => {
            const [inputA, setInputA] = useState(false);
            const [inputB, setInputB] = useState(false);
            const [gateType, setGateType] = useState('AND'); // AND, OR, NOT

            const getOutput = () => {
                if (gateType === 'AND') return inputA && inputB;
                if (gateType === 'OR') return inputA || inputB;
                if (gateType === 'NOT') return !inputA;
                return false;
            };

            const output = getOutput();

            return (
                <div className="p-4 grid md:grid-cols-2 gap-8 items-center">
                    <div className="space-y-6">
                        <div className="flex gap-4 mb-6">
                            {['AND', 'OR', 'NOT'].map(t => (
                                <button 
                                    key={t} 
                                    onClick={() => { setGateType(t); setInputA(false); setInputB(false); }}
                                    className={`mc-btn px-4 py-2 flex-1 ${gateType === t ? 'text-yellow-300 border-yellow-500' : ''}`}
                                >
                                    {t} é—¨
                                </button>
                            ))}
                        </div>

                        <div className="bg-[#c6c6c6] p-6 border-4 border-[#555] text-black relative h-64 flex flex-col justify-center">
                            {/* Visual Circuit */}
                            <div className="flex items-center justify-between relative z-10">
                                <div className="flex flex-col gap-8">
                                    <div 
                                        onClick={() => setInputA(!inputA)}
                                        className={`cursor-pointer w-12 h-12 border-4 border-[#555] flex items-center justify-center font-bold text-xl shadow-md transition-all ${inputA ? 'bg-red-600 text-white' : 'bg-[#888] text-gray-300'}`}
                                    >
                                        A
                                    </div>
                                    {gateType !== 'NOT' && (
                                        <div 
                                            onClick={() => setInputB(!inputB)}
                                            className={`cursor-pointer w-12 h-12 border-4 border-[#555] flex items-center justify-center font-bold text-xl shadow-md transition-all ${inputB ? 'bg-red-600 text-white' : 'bg-[#888] text-gray-300'}`}
                                        >
                                            B
                                        </div>
                                    )}
                                </div>

                                {/* Logic Gate Box */}
                                <div className="w-24 h-24 bg-[#555] border-4 border-black flex flex-col items-center justify-center text-white shadow-xl">
                                    <span className="text-3xl font-bold">{gateType}</span>
                                    <span className="text-xs text-gray-400 mt-1">Logic</span>
                                </div>

                                {/* Output Lamp */}
                                <div className={`w-16 h-16 border-4 border-[#555] transition-all duration-200 shadow-lg ${output ? 'bg-yellow-300 shadow-[0_0_30px_rgba(253,224,71,0.8)]' : 'bg-[#440000]'}`}></div>
                            </div>

                            {/* Wires (CSS Lines) */}
                            <svg className="absolute inset-0 w-full h-full pointer-events-none z-0">
                                {/* Wire A */}
                                <line x1="15%" y1={gateType === 'NOT' ? "50%" : "30%"} x2="40%" y2="50%" stroke={inputA ? "#dc2626" : "#5a1a1a"} strokeWidth="6" />
                                {/* Wire B */}
                                {gateType !== 'NOT' && <line x1="15%" y1="70%" x2="40%" y2="50%" stroke={inputB ? "#dc2626" : "#5a1a1a"} strokeWidth="6" />}
                                {/* Wire Out */}
                                <line x1="60%" y1="50%" x2="85%" y2="50%" stroke={output ? "#dc2626" : "#5a1a1a"} strokeWidth="6" />
                            </svg>
                        </div>
                    </div>

                    <div className="bg-black/40 p-6 border border-gray-600 rounded-lg">
                        <h3 className="text-xl text-yellow-400 mb-4 font-bold flex items-center gap-2">
                            <Icon name="Code" /> ä»£ç é€»è¾‘æ˜ å°„
                        </h3>
                        <div className="font-mono text-lg space-y-4">
                            {gateType === 'AND' && (
                                <>
                                    <div className="text-gray-400">// ä¸¤ä¸ªå¼€å…³éƒ½å¼€ï¼Œç¯æ‰äº®</div>
                                    <div>
                                        <span className="text-purple-400">if</span> (
                                        <span className={inputA ? "text-green-400" : "text-red-400"}>inputA</span> 
                                        <span className="text-yellow-300"> && </span> 
                                        <span className={inputB ? "text-green-400" : "text-red-400"}>inputB</span>
                                        ) {'{'}
                                    </div>
                                    <div className="pl-8 text-green-300">light.turnOn();</div>
                                    <div>{'}'}</div>
                                </>
                            )}
                            {gateType === 'OR' && (
                                <>
                                    <div className="text-gray-400">// ä»»æ„ä¸€ä¸ªå¼€å…³å¼€ï¼Œç¯å°±äº®</div>
                                    <div>
                                        <span className="text-purple-400">if</span> (
                                        <span className={inputA ? "text-green-400" : "text-red-400"}>inputA</span> 
                                        <span className="text-yellow-300"> || </span> 
                                        <span className={inputB ? "text-green-400" : "text-red-400"}>inputB</span>
                                        ) {'{'}
                                    </div>
                                    <div className="pl-8 text-green-300">light.turnOn();</div>
                                    <div>{'}'}</div>
                                </>
                            )}
                            {gateType === 'NOT' && (
                                <>
                                    <div className="text-gray-400">// çº¢çŸ³ç«æŠŠï¼šä¿¡å·åè½¬</div>
                                    <div>
                                        <span className="text-purple-400">if</span> (
                                        <span className="text-yellow-300">!</span>
                                        <span className={inputA ? "text-green-400" : "text-red-400"}>inputA</span> 
                                        ) {'{'}
                                    </div>
                                    <div className="pl-8 text-green-300">light.turnOn();</div>
                                    <div>{'}'}</div>
                                </>
                            )}
                        </div>
                        <div className="mt-6 pt-4 border-t border-gray-700 text-sm text-gray-400">
                            çº¢çŸ³ç”µè·¯æœ¬è´¨ä¸Šå°±æ˜¯å¯è§†åŒ–çš„äºŒè¿›åˆ¶é€»è¾‘ç”µè·¯ã€‚è®¡ç®—æœº CPU å†…éƒ¨å°±æ˜¯ç”±æ•°äº¿ä¸ªè¿™æ ·çš„å¾®å‹â€œçº¢çŸ³é—¨â€ï¼ˆæ™¶ä½“ç®¡ï¼‰ç»„æˆçš„ã€‚
                        </div>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('server'); // server, network, arch, logic, rendering

            const tabs = [
                { id: 'server', label: 'æœåŠ¡å™¨åŸºçŸ³ (Hardware)', icon: 'Server' },
                { id: 'network', label: 'ç½‘ç»œè”é€š (Network)', icon: 'Network' },
                { id: 'arch', label: 'å¹½çµæ–¹å— (Architecture)', icon: 'Zap' },
                { id: 'rendering', label: 'æœ¬åœ°æ¸²æŸ“ (Graphics)', icon: 'Monitor' },
                { id: 'logic', label: 'çº¢çŸ³é€»è¾‘ (Programming)', icon: 'Code' },
            ];

            const renderContent = () => {
                switch(activeTab) {
                    case 'server': return <ServerConfig />;
                    case 'network': return <NetworkSim />;
                    case 'arch': return <ClientServerDemo />;
                    case 'rendering': return <ClientRendering />;
                    case 'logic': return <RedstoneLogic />;
                    default: return <ServerConfig />;
                }
            };

            return (
                <div className="max-w-5xl mx-auto w-full py-8 px-4 flex flex-col h-screen">
                    {/* Title Block */}
                    <div className="text-center mb-8">
                        <h1 className="text-4xl md:text-6xl text-white drop-shadow-[4px_4px_0_#000] mb-2">MINECRAFT SCIENCE</h1>
                        <p className="text-xl text-gray-300 bg-black/50 inline-block px-4 py-1 rounded">
                            ä»æ–¹å—åˆ°æ¯”ç‰¹ï¼šä¸€ä¸ªå…¨æ ˆè®¡ç®—æœºç§‘å­¦æ¨¡æ‹Ÿå™¨
                        </p>
                    </div>

                    {/* Navigation (Hotbar Style) */}
                    <div className="flex justify-center mb-8 overflow-x-auto">
                        <div className="bg-[#c6c6c6] p-2 border-4 border-[#555] flex gap-2 shadow-2xl">
                            {tabs.map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`
                                        relative w-16 h-16 md:w-20 md:h-20 flex flex-col items-center justify-center border-4 transition-all group
                                        ${activeTab === tab.id 
                                            ? 'bg-[#8b8b8b] border-white scale-110 z-10 shadow-lg' 
                                            : 'bg-[#8b8b8b] border-[#373737] hover:bg-[#a0a0a0]'}
                                    `}
                                    title={tab.label}
                                >
                                    <Icon name={tab.icon} className={activeTab === tab.id ? "text-yellow-300" : "text-white"} size={32} />
                                    {activeTab === tab.id && <div className="absolute -bottom-8 bg-black text-white text-xs px-2 py-1 whitespace-nowrap border border-white z-20">{tab.label}</div>}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Main Content Area (Inventory Style) */}
                    <div className="flex-1 bg-[#c6c6c6] border-4 border-[#373737] p-1 shadow-2xl overflow-hidden flex flex-col relative">
                        <div className="absolute top-0 left-0 w-full h-1 bg-white opacity-20"></div>
                        <div className="absolute top-0 left-0 h-full w-1 bg-white opacity-20"></div>
                        
                        <div className="bg-[#1a1a1a] w-full h-full border-4 border-[#8b8b8b] overflow-y-auto relative">
                            {renderContent()}
                        </div>
                    </div>

                    <div className="text-center text-gray-500 mt-8 text-sm">
                        Capstone Project - Generated by AI Assistant
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>