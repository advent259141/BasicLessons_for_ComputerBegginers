<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows è¿›é˜¶æŒ‡å—ï¼šGUI ä¹‹ä¸‹ (å®Œæ•´ä¿®å¤ç‰ˆ)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #0f172a;
            color: #e2e8f0;
            font-family: 'Noto Sans SC', sans-serif;
            overflow: hidden;
        }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* ä¾§è¾¹æ é€‰ä¸­æ€ */
        .nav-item.active {
            background: rgba(56, 189, 248, 0.1);
            border-left: 4px solid #38bdf8;
            color: #38bdf8;
        }

        /* æ¨¡æ‹Ÿç»ˆç«¯å…‰æ ‡ */
        .cursor-blink {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        /* æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }

        /* Windows çª—å£é£æ ¼æ»šåŠ¨æ¡ */
        .win-scroll::-webkit-scrollbar { width: 12px; }
        .win-scroll::-webkit-scrollbar-track { background: #2d2d2d; border-left: 1px solid #3e3e3e; }
        .win-scroll::-webkit-scrollbar-thumb { background: #666; border: 2px solid #2d2d2d; }
        .win-scroll::-webkit-scrollbar-thumb:hover { background: #888; }

        /* ä»»åŠ¡ç®¡ç†å™¨ä¸“ç”¨åŠ¨ç”» */
        @keyframes bounce-short {
            0%, 100% { transform: translate(-50%, -50%); }
            50% { transform: translate(-50%, -60%); }
        }
        .animate-hint {
            animation: bounce-short 2s infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- 1. ç»ˆç«¯æ¨¡æ‹Ÿå™¨ (CMD vs PowerShell) ---
        const TerminalSection = () => {
            const [mode, setMode] = useState('cmd');
            const [output, setOutput] = useState([
                { text: "Microsoft Windows [ç‰ˆæœ¬ 10.0.19045.3693]", type: 'info' },
                { text: "(c) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚", type: 'info' },
                { text: "", type: 'empty' }
            ]);

            const runCommand = (cmdText) => {
                setOutput(prev => [...prev, { text: `C:\\Users\\Admin> ${cmdText}`, type: 'command' }]);
                
                setTimeout(() => {
                    if (cmdText === 'ping 8.8.8.8') {
                        const responses = [
                            "æ­£åœ¨ Ping 8.8.8.8 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:",
                            "æ¥è‡ª 8.8.8.8 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=45ms TTL=116",
                            "æ¥è‡ª 8.8.8.8 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=46ms TTL=116",
                            "Ping ç»Ÿè®¡ä¿¡æ¯: æ•°æ®åŒ…: å·²å‘é€ = 2ï¼Œå·²æ¥æ”¶ = 2ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)"
                        ];
                        responses.forEach((line, i) => {
                            setTimeout(() => setOutput(prev => [...prev, { text: line, type: 'result' }]), i * 500);
                        });
                    } else if (cmdText.includes('Get-ChildItem')) {
                        setOutput(prev => [...prev, 
                            { text: "ç›®å½•: C:\\Work\\Docs", type: 'result' },
                            { text: "Mode                 LastWriteTime         Length Name", type: 'result' },
                            { text: "----                 -------------         ------ ----", type: 'result' },
                            { text: "-a----        2024/5/20     14:23          1204  Report_2023.docx", type: 'result' },
                            { text: "-a----        2024/5/20     14:24          3521  Budget_2023.xlsx", type: 'result' },
                            { text: ">>> æ‰§è¡Œè‡ªåŠ¨åŒ–è„šæœ¬ï¼šæ­£åœ¨å°†æ–‡ä»¶åä¸­çš„ '2023' æ‰¹é‡æ›¿æ¢ä¸º '2024'...", type: 'success' },
                            { text: ">>> å®Œæˆï¼æ‰€æœ‰æ–‡ä»¶å·²æ›´æ–°ã€‚", type: 'success' }
                        ]);
                    }
                }, 300);
            };

            return (
                <div className="h-full flex flex-col gap-4">
                    <div className="flex gap-4 mb-2">
                        <button 
                            onClick={() => { setMode('cmd'); setOutput([{ text: "Microsoft Windows [ç‰ˆæœ¬ 10.0.19045]", type: 'info' }]); }}
                            className={`px-4 py-2 rounded font-mono text-sm transition-colors border ${mode === 'cmd' ? 'bg-gray-800 border-gray-500 text-white' : 'border-gray-700 text-gray-500'}`}
                        >
                            CMD (è€ç®¡å®¶)
                        </button>
                        <button 
                            onClick={() => { setMode('ps'); setOutput([{ text: "Windows PowerShell", type: 'info' }, { text: "ç‰ˆæƒæ‰€æœ‰ (C) Microsoft Corporationã€‚", type: 'info' }]); }}
                            className={`px-4 py-2 rounded font-mono text-sm transition-colors border ${mode === 'ps' ? 'bg-blue-900/50 border-blue-500 text-blue-200' : 'border-gray-700 text-gray-500'}`}
                        >
                            PowerShell (é­”æ³•æ£’)
                        </button>
                    </div>

                    <div className={`flex-1 rounded-lg p-4 font-mono text-sm overflow-y-auto border border-gray-700 shadow-inner ${mode === 'cmd' ? 'bg-black text-gray-300' : 'bg-[#012456] text-white'}`}>
                        {output.map((line, i) => (
                            <div key={i} className={`mb-1 ${line.type === 'success' ? 'text-green-400' : line.type === 'command' ? 'text-yellow-300' : ''}`}>
                                {line.text}
                            </div>
                        ))}
                        <div className="animate-pulse">_</div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        <div 
                            onClick={() => runCommand('ping 8.8.8.8')}
                            className="p-3 bg-gray-800 hover:bg-gray-700 rounded border border-gray-600 cursor-pointer flex flex-col gap-1"
                        >
                            <span className="font-bold text-gray-300">ç®€å•ä»»åŠ¡ (Ping)</span>
                            <span className="text-xs text-gray-400">æµ‹è¯•ç½‘ç»œé€šä¸é€šï¼Œç®€å•ç²—æš´ã€‚</span>
                            <code className="text-xs bg-black/30 p-1 rounded mt-1 text-green-400">&gt; ping 8.8.8.8</code>
                        </div>
                        <div 
                            onClick={() => {
                                if(mode !== 'ps') { alert('è¯·å…ˆåˆ‡æ¢åˆ° PowerShellï¼\nCMD å¬ä¸æ‡‚è¿™ä¹ˆé«˜çº§çš„å’’è¯­ã€‚'); return; }
                                runCommand('Get-ChildItem *.docx | Rename-Item -NewName { $_.Name -replace "2023","2024" }');
                            }}
                            className={`p-3 rounded border cursor-pointer flex flex-col gap-1 ${mode === 'ps' ? 'bg-blue-900/30 border-blue-600 hover:bg-blue-900/50' : 'bg-gray-800/50 border-gray-700 opacity-50'}`}
                        >
                            <span className="font-bold text-blue-300">è‡ªåŠ¨åŒ–é­”æ³• (æ‰¹é‡æ”¹å)</span>
                            <span className="text-xs text-gray-400">ä¸€è¡Œä»£ç ä¿®æ”¹1000ä¸ªæ–‡ä»¶åã€‚</span>
                            <code className="text-xs bg-black/30 p-1 rounded mt-1 text-blue-200">&gt; Get-ChildItem...</code>
                        </div>
                    </div>
                </div>
            );
        };

        // --- 2. æ–‡ä»¶ç³»ç»Ÿ (åˆ†åŒºã€ç›˜ç¬¦ä¸æ ¼å¼åŒ–) ---
        const FileSystemSection = () => {
            const [showExt, setShowExt] = useState(false);
            const [driveStatus, setDriveStatus] = useState('ready');
            const [progress, setProgress] = useState(0);

            const startFormat = () => {
                if (driveStatus === 'formatting') return;
                setDriveStatus('formatting');
                setProgress(0);
                let p = 0;
                const interval = setInterval(() => {
                    p += 2;
                    setProgress(p);
                    if (p >= 100) {
                        clearInterval(interval);
                        setDriveStatus('empty');
                    }
                }, 50);
            };

            const resetDrive = () => {
                setDriveStatus('ready');
                setProgress(0);
            };
            
            return (
                <div className="space-y-8 h-full pr-2">
                    <div className="space-y-4">
                        <div className="flex items-center justify-between bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <div>
                                <h3 className="text-lg font-bold text-white">1. æ–‡ä»¶æ‰©å±•åæ©æŠ¤å®éªŒ</h3>
                                <p className="text-sm text-gray-400">Windows é»˜è®¤ä¼šéšè—å·²çŸ¥åç¼€åï¼Œè¿™å¾ˆå±é™©ã€‚</p>
                            </div>
                            <label className="flex items-center cursor-pointer">
                                <div className="mr-3 text-sm font-medium text-gray-300">
                                    {showExt ? "æ‰©å±•å: [å·²æ˜¾ç¤º]" : "æ‰©å±•å: [å·²éšè—]"}
                                </div>
                                <div className="relative">
                                    <input type="checkbox" className="sr-only" checked={showExt} onChange={() => setShowExt(!showExt)} />
                                    <div className={`block w-14 h-8 rounded-full transition-colors ${showExt ? 'bg-green-500' : 'bg-gray-600'}`}></div>
                                    <div className={`dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${showExt ? 'transform translate-x-6' : ''}`}></div>
                                </div>
                            </label>
                        </div>

                        <div className="grid grid-cols-2 gap-6">
                            <div className={`p-4 rounded-lg border flex items-center gap-4 transition-colors group relative overflow-hidden ${showExt ? 'bg-red-900/20 border-red-500' : 'bg-slate-800 border-slate-700'}`}>
                                {showExt && <div className="absolute top-0 right-0 bg-red-600 text-white text-xs px-2 py-1">è­¦å‘Š</div>}
                                <div className="text-4xl group-hover:scale-110 transition-transform">
                                    {showExt ? 'ğŸ‘¾' : 'ğŸ–¼ï¸'}
                                </div>
                                <div>
                                    <div className="text-white font-mono text-base">
                                        ç¾å¥³ç…§ç‰‡{showExt ? <span className="text-red-400 font-bold bg-red-900/30 px-1 rounded">.exe</span> : <span className="text-gray-400 opacity-0">.jpg</span>}
                                    </div>
                                    <div className={`text-xs mt-1 ${showExt ? 'text-red-400 font-bold' : 'text-gray-500'}`}>
                                        {showExt ? "å®é™…æ˜¯ï¼šå¯æ‰§è¡Œç¨‹åº (ç—…æ¯’!)" : "çœ‹èµ·æ¥æ˜¯ï¼šå›¾ç‰‡"}
                                    </div>
                                </div>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg border border-slate-700 flex items-center gap-4">
                                <div className="text-4xl">ğŸ“„</div>
                                <div>
                                    <div className="text-white font-mono text-base">
                                        æ¯•ä¸šè®ºæ–‡{showExt && <span className="text-yellow-400 font-bold bg-yellow-900/30 px-1 rounded">.docx</span>}
                                    </div>
                                    <div className="text-xs text-gray-500 mt-1">Microsoft Word æ–‡æ¡£</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <h3 className="text-lg font-bold text-white mb-4 flex items-center gap-2 border-b border-gray-700 pb-2">
                            <span className="text-2xl">ğŸ’½</span> ç¡¬ç›˜åˆ†åŒºä¸æ ¼å¼åŒ–å®éªŒå®¤
                        </h3>
                        <div className="mb-6">
                            <div className="text-sm text-gray-400 mb-2 flex justify-between">
                                <span>ç‰©ç†ç¡¬ç›˜ (Disk 0) - 1TB SSD</span>
                                <span className="text-xs bg-gray-700 px-2 rounded text-gray-300">æ¯”å–»ï¼šä¸€å¥—æˆ¿å­è¢«éš”æˆäº†ä¸¤ä¸ªæˆ¿é—´</span>
                            </div>
                            <div className="flex h-20 w-full rounded-lg overflow-hidden border-2 border-gray-600 font-mono text-xs shadow-lg">
                                <div className="w-1/3 bg-blue-900/80 flex flex-col items-center justify-center text-white border-r-2 border-gray-800 relative group cursor-help transition-all hover:bg-blue-800">
                                    <span className="font-bold text-xl">C:</span>
                                    <span className="text-blue-200">ç³»ç»Ÿåˆ†åŒº (NTFS)</span>
                                </div>
                                <div className="flex-1 bg-gray-700/50 flex flex-col items-center justify-center text-gray-200 relative transition-all">
                                    {driveStatus === 'formatting' ? (
                                        <div className="w-full px-8">
                                            <div className="text-center mb-2 text-yellow-400 font-bold animate-pulse">
                                                æ­£åœ¨æ¨å¹³åœ°é¢... {progress}%
                                            </div>
                                            <div className="w-full bg-gray-800 h-3 rounded-full overflow-hidden border border-gray-600">
                                                <div className="bg-yellow-400 h-full transition-all duration-100 ease-linear" style={{width: `${progress}%`}}></div>
                                            </div>
                                        </div>
                                    ) : driveStatus === 'empty' ? (
                                        <div className="flex flex-col items-center animate-bounce-short">
                                            <span className="font-bold text-xl text-gray-300">D:</span>
                                            <span className="text-green-400 font-bold">å¯ç”¨ç©ºé—´ 100%</span>
                                        </div>
                                    ) : (
                                        <>
                                            <span className="font-bold text-xl">D:</span>
                                            <span>æ•°æ®åˆ†åŒº</span>
                                            <div className="flex gap-2 mt-2 opacity-60 text-lg">
                                                <span>ğŸ“„</span><span>ğŸ“</span><span>ğŸµ</span><span>ğŸ®</span>
                                            </div>
                                        </>
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="bg-black/40 p-5 rounded border border-red-500/20 flex flex-col md:flex-row gap-6 items-start">
                            <div className="flex-1">
                                <h4 className="text-red-400 font-bold text-sm mb-2 flex items-center gap-2">
                                    <span className="text-lg">âš ï¸</span> ä»€ä¹ˆæ˜¯â€œæ ¼å¼åŒ– (Format)â€ï¼Ÿ
                                </h4>
                                <p className="text-xs text-gray-300 leading-relaxed mb-3">
                                    è®¸å¤šå°ç™½ä»¥ä¸ºæ ¼å¼åŒ–åªæ˜¯â€œåˆ é™¤æ‰€æœ‰æ–‡ä»¶â€ã€‚é”™ï¼<br/>
                                    æ ¼å¼åŒ–çš„æœ¬è´¨æ˜¯ï¼š<strong className="text-white border-b border-white/30">æŠŠä»“åº“é‡Œçš„è´§æ¶å…¨éƒ¨æ‹†é™¤ï¼Œåœ°æ¿é“²å¹³ï¼Œç„¶åé‡æ–°ç”»åœè½¦ä½ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰</strong>ã€‚
                                </p>
                            </div>
                            <div className="flex flex-col gap-3 min-w-[120px]">
                                <button 
                                    onClick={startFormat}
                                    disabled={driveStatus !== 'ready'}
                                    className={`px-4 py-3 rounded font-bold text-xs transition-all transform active:scale-95 flex items-center justify-center gap-2 ${driveStatus === 'ready' ? 'bg-red-600 hover:bg-red-500 text-white shadow-lg' : 'bg-gray-700 text-gray-500 cursor-not-allowed'}`}
                                >
                                    {driveStatus === 'formatting' ? "â³ æ–½å·¥ä¸­..." : "ğŸ§¹ æ ¼å¼åŒ– D ç›˜"}
                                </button>
                                {driveStatus === 'empty' && (
                                    <button onClick={resetDrive} className="text-xs text-blue-400 hover:text-blue-300 hover:underline text-center">
                                        â†º é‡ç½®
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- 3. æ³¨å†Œè¡¨ (DNA) ---
        const RegistrySection = () => {
            const [speed, setSpeed] = useState(10);
            
            return (
                <div className="flex gap-6 h-full">
                    <div className="flex-1 bg-slate-800 rounded-lg p-6 border border-slate-700 flex flex-col items-center justify-center gap-8">
                        <div className="text-center">
                            <h4 className="text-gray-400 mb-2">ç³»ç»Ÿå½“å‰è¡¨ç°</h4>
                            <div className="relative w-32 h-32 flex items-center justify-center border-4 border-gray-600 rounded-full">
                                <div 
                                    className="w-2 h-16 bg-cyan-400 origin-bottom absolute bottom-1/2 left-1/2 -ml-1 rounded-full"
                                    style={{ transform: `rotate(${speed * 18}deg)`, transition: 'transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)' }}
                                ></div>
                                <div className="w-4 h-4 bg-white rounded-full absolute z-10"></div>
                            </div>
                            <div className="mt-4 font-mono text-xl text-cyan-400">Value: {speed}</div>
                        </div>
                        <p className="text-xs text-gray-500 text-center max-w-xs">
                            æ”¹å˜å³ä¾§æ³¨å†Œè¡¨çš„å€¼ï¼Œç³»ç»Ÿè¡Œä¸ºï¼ˆè¡¨ç›˜ï¼‰ä¼šç«‹å³å‘ç”Ÿæ ¹æœ¬æ€§æ”¹å˜ã€‚
                        </p>
                    </div>

                    <div className="flex-1 bg-white text-black font-sans text-xs flex flex-col border border-gray-400 shadow-xl">
                        <div className="bg-gray-100 p-1 border-b flex items-center gap-2">
                            <span className="text-yellow-600">ğŸ’¾</span> æ³¨å†Œè¡¨ç¼–è¾‘å™¨
                        </div>
                        <div className="flex flex-1 overflow-hidden">
                            <div className="w-1/3 border-r border-gray-200 p-2 overflow-y-auto">
                                <div className="pl-2">ğŸ“‚ Computer</div>
                                <div className="pl-4">ğŸ“‚ HKEY_CURRENT_USER</div>
                                <div className="pl-6">ğŸ“‚ Control Panel</div>
                                <div className="pl-8 bg-blue-100 border border-blue-300 text-blue-800 px-1">ğŸ“‚ Mouse</div>
                            </div>
                            <div className="flex-1 p-2 bg-white">
                                <div className="grid grid-cols-3 font-bold border-b mb-2 pb-1 text-gray-500">
                                    <span>åç§°</span>
                                    <span>ç±»å‹</span>
                                    <span>æ•°æ®</span>
                                </div>
                                <div className="grid grid-cols-3 py-1 hover:bg-blue-50 cursor-pointer bg-blue-100 group">
                                    <span>ğŸ”‘ MouseSpeed</span>
                                    <span>REG_SZ</span>
                                    <span className="font-bold">{speed}</span>
                                </div>
                                <div className="mt-8 p-4 bg-gray-100 border rounded">
                                    <label className="block mb-2 font-bold">ç¼–è¾‘å­—ç¬¦ä¸² (æ¨¡æ‹Ÿ)</label>
                                    <input 
                                        type="range" min="0" max="20" 
                                        value={speed} 
                                        onChange={(e) => setSpeed(e.target.value)}
                                        className="w-full"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- 4. ä»»åŠ¡ç®¡ç†å™¨ (Windows 10/11 é£æ ¼é‡ç»˜ç‰ˆ + æ€§èƒ½Tabè”åŠ¨) ---
        const TaskManagerSection = () => {
            const [activeTab, setActiveTab] = useState('processes'); // processes, performance
            const [selectedId, setSelectedId] = useState(null);
            const [processes, setProcesses] = useState([
                { id: 1, name: 'Google Chrome', status: 'Running', cpu: 1.2, mem: 450, disk: 0.1, net: 0, type: 'app', icon: 'ğŸŒ' },
                { id: 2, name: 'Steam Client Bootstrapper', status: 'Running', cpu: 2.5, mem: 120, disk: 0, net: 0.1, type: 'app', icon: 'ğŸ®' },
                { id: 3, name: 'Visual Studio Code', status: 'Running', cpu: 0.5, mem: 280, disk: 0, net: 0, type: 'app', icon: 'ğŸ“' },
                { id: 4, name: 'Service Host: Local System', status: 'Running', cpu: 0.1, mem: 15, disk: 0, net: 0, type: 'bg', icon: 'âš™ï¸' },
                { id: 5, name: 'System Interrupts', status: 'Running', cpu: 0.1, mem: 0.1, disk: 0, net: 0, type: 'bg', icon: 'âš¡' },
                { id: 6, name: 'CRASH_DEMO_APP.exe', status: 'Not Responding', cpu: 99.9, mem: 2048, disk: 50, net: 0, type: 'stuck', icon: 'âš ï¸' },
            ]);

            const [perfType, setPerfType] = useState('cpu'); // cpu, mem, disk, net
            
            // åˆå§‹åŒ–æ•°æ®
            const [perfData, setPerfData] = useState(() => {
                const hasCrash = processes.some(p => p.type === 'stuck');
                return Array(60).fill(hasCrash ? 100 : 10);
            });

            // æ¨¡æ‹Ÿå®æ—¶æ€§èƒ½æ•°æ®æ³¢åŠ¨
            useEffect(() => {
                if (activeTab === 'performance') {
                    const interval = setInterval(() => {
                        setPerfData(prev => {
                            const newData = [...prev.slice(1)];
                            const hasCrashApp = processes.some(p => p.type === 'stuck');
                            let base = 0;
                            let noise = Math.random() * 5;

                            if (perfType === 'cpu') {
                                if (hasCrashApp) {
                                    base = 98;
                                    noise = Math.random() * 2;
                                } else {
                                    base = 10;
                                    noise = Math.random() * 15;
                                }
                            } else if (perfType === 'mem') {
                                base = hasCrashApp ? 55 : 40; 
                                noise = Math.random() * 2 - 1;
                            } else if (perfType === 'disk') {
                                base = hasCrashApp ? 40 : 1; 
                                noise = Math.random() * 5;
                            } else {
                                base = 0;
                                noise = Math.random() * 2;
                            }

                            newData.push(Math.max(0, Math.min(100, base + noise)));
                            return newData;
                        });
                    }, 500); 
                    return () => clearInterval(interval);
                }
            }, [activeTab, perfType, processes]);

            const handleEndTask = () => {
                if (selectedId) {
                    setProcesses(prev => prev.filter(p => p.id !== selectedId));
                    setSelectedId(null);
                }
            };

            const getHeatMapColor = (value, type) => {
                if (type === 'cpu') {
                    if (value > 90) return 'bg-[#e04f5f] text-white'; 
                    if (value > 50) return 'bg-[#d28028] text-white'; 
                    if (value > 10) return 'bg-[#cfae3d] text-black'; 
                }
                if (type === 'mem') {
                    if (value > 1000) return 'bg-[#ddae58] text-black';
                    if (value > 500) return 'bg-[#eadd83] text-black';
                }
                if (type === 'disk' && value > 10) return 'bg-[#e04f5f] text-white';
                return 'transparent';
            };

            const MiniChart = ({ data, color = "#60a5fa" }) => {
                const width = 60;
                const height = 30;
                const points = data.slice(-20).map((val, i) => {
                    const x = (i / 19) * width;
                    const y = height - (val / 100) * height;
                    return `${x},${y}`;
                }).join(' ');
                return (
                    <svg width="100%" height="100%" viewBox={`0 0 ${width} ${height}`} preserveAspectRatio="none">
                        <polyline points={points} fill="none" stroke={color} strokeWidth="1.5" />
                    </svg>
                );
            };

            const BigChart = ({ data, color = "#60a5fa" }) => {
                const width = 400;
                const height = 150;
                const points = data.map((val, i) => {
                    const x = (i / (data.length - 1)) * width;
                    const y = height - (val / 100) * height;
                    return `${x},${y}`;
                }).join(' ');
                const areaPoints = `${points} ${width},${height} 0,${height}`;

                return (
                    <svg width="100%" height="100%" viewBox={`0 0 ${width} ${height}`} preserveAspectRatio="none">
                        <defs>
                            <linearGradient id="chartGradient" x1="0" y1="0" x2="0" y2="1">
                                <stop offset="0%" stopColor={color} stopOpacity="0.2"/>
                                <stop offset="100%" stopColor={color} stopOpacity="0"/>
                            </linearGradient>
                        </defs>
                        <polygon points={areaPoints} fill="url(#chartGradient)" />
                        <polyline points={points} fill="none" stroke={color} strokeWidth="2" />
                        <line x1="0" y1="0" x2={width} y2="0" stroke="#444" strokeWidth="0.5" strokeDasharray="4" />
                        <line x1="0" y1={height/2} x2={width} y2={height/2} stroke="#444" strokeWidth="0.5" strokeDasharray="4" />
                        <line x1="0" y1={height} x2={width} y2={height} stroke="#444" strokeWidth="0.5" strokeDasharray="4" />
                    </svg>
                );
            };

            const PerfSidebarItem = ({ title, subtitle, value, type, active, onClick }) => (
                <div 
                    onClick={onClick}
                    className={`p-2 border-l-4 cursor-pointer hover:bg-[#3a3a3a] transition-colors flex gap-3 items-center h-16 ${active ? 'bg-[#3a3a3a] border-blue-500' : 'border-transparent'}`}
                >
                    <div className="flex-1 min-w-0">
                        <div className="font-bold text-sm truncate">{title}</div>
                        <div className="text-xs text-gray-400 truncate">{subtitle}</div>
                    </div>
                    <div className="flex flex-col items-end w-20">
                        <div className="font-mono text-sm">{value}</div>
                        <div className="w-16 h-8 mt-1 opacity-70">
                            {active ? <MiniChart data={perfData} /> : <MiniChart data={type === 'cpu' && processes.some(p=>p.type==='stuck') ? Array(20).fill(100) : Array(20).fill(5)} color="#888"/>}
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="h-full flex flex-col bg-[#202020] text-white font-sans text-xs border border-gray-600 rounded-lg shadow-2xl overflow-hidden select-none relative">
                    <div className="bg-[#2d2d2d] p-2 flex justify-between items-center border-b border-gray-600">
                        <div className="flex items-center gap-2">
                            <span className="w-4 h-4 bg-blue-500 rounded-sm flex items-center justify-center text-[10px]">ğŸ“Š</span>
                            <span className="text-xs font-normal">ä»»åŠ¡ç®¡ç†å™¨</span>
                        </div>
                        <div className="flex gap-4 px-2">
                             <span className="w-3 h-3 border border-gray-500 rounded-sm"></span>
                             <span className="w-3 h-3 border border-gray-500 rounded-sm"></span>
                             <span className="w-3 h-3 border border-gray-500 rounded-sm bg-red-500 border-red-500"></span>
                        </div>
                    </div>

                    <div className="bg-[#2d2d2d] flex gap-1 px-2 pt-1 border-b border-gray-600 text-gray-400">
                        <div 
                            onClick={() => setActiveTab('processes')}
                            className={`px-3 py-1 rounded-t-sm cursor-pointer transition-colors ${activeTab === 'processes' ? 'bg-[#202020] text-white border-t border-l border-r border-gray-600' : 'hover:bg-[#3a3a3a]'}`}
                        >
                            è¿›ç¨‹
                        </div>
                        <div 
                            onClick={() => setActiveTab('performance')}
                            className={`px-3 py-1 rounded-t-sm cursor-pointer transition-colors ${activeTab === 'performance' ? 'bg-[#202020] text-white border-t border-l border-r border-gray-600' : 'hover:bg-[#3a3a3a]'}`}
                        >
                            æ€§èƒ½
                        </div>
                        <div className="px-3 py-1 hover:bg-[#3a3a3a] rounded-t-sm cursor-not-allowed opacity-50">åº”ç”¨å†å²è®°å½•</div>
                        <div className="px-3 py-1 hover:bg-[#3a3a3a] rounded-t-sm cursor-not-allowed opacity-50">å¯åŠ¨</div>
                        <div className="px-3 py-1 hover:bg-[#3a3a3a] rounded-t-sm cursor-not-allowed opacity-50">ç”¨æˆ·</div>
                    </div>
                    
                    <div className="flex-1 overflow-hidden bg-[#202020] relative">
                        {activeTab === 'processes' && (
                            <div className="h-full flex flex-col">
                                <div className="grid grid-cols-12 bg-[#2d2d2d] border-b border-gray-600 text-gray-400 py-1 px-2 gap-1 items-center font-bold">
                                    <div className="col-span-5 pl-2 border-r border-gray-600 hover:bg-[#3a3a3a] cursor-default">åç§°</div>
                                    <div className="col-span-2 pl-2 border-r border-gray-600 hover:bg-[#3a3a3a] cursor-default">çŠ¶æ€</div>
                                    <div className="col-span-1 pl-2 border-r border-gray-600 hover:bg-[#3a3a3a] text-right pr-2 cursor-default">CPU</div>
                                    <div className="col-span-2 pl-2 border-r border-gray-600 hover:bg-[#3a3a3a] text-right pr-2 cursor-default">å†…å­˜</div>
                                    <div className="col-span-1 pl-2 border-r border-gray-600 hover:bg-[#3a3a3a] text-right pr-2 cursor-default">ç£ç›˜</div>
                                    <div className="col-span-1 pl-2 hover:bg-[#3a3a3a] text-right pr-2 cursor-default">ç½‘ç»œ</div>
                                </div>

                                <div className="flex-1 overflow-y-auto bg-[#202020] win-scroll">
                                    {processes.map(p => (
                                        <div 
                                            key={p.id}
                                            onClick={() => setSelectedId(p.id)}
                                            className={`grid grid-cols-12 gap-1 py-[3px] px-2 items-center cursor-default ${selectedId === p.id ? 'bg-[#43505c]' : 'hover:bg-[#2a2a2a]'}`}
                                        >
                                            <div className="col-span-5 flex items-center gap-2 overflow-hidden pl-2">
                                                <span className="flex-shrink-0 w-4 h-4 text-center opacity-80">{p.icon}</span>
                                                <span className="truncate" title={p.name}>{p.name}</span>
                                            </div>
                                            <div className={`col-span-2 truncate pl-2 ${p.status === 'Not Responding' ? 'text-red-400' : 'text-gray-400'}`}>
                                                {p.status === 'Running' ? '' : p.status}
                                            </div>
                                            <div className={`col-span-1 text-right pr-2 ${getHeatMapColor(p.cpu, 'cpu')}`}>
                                                {p.cpu.toFixed(1)}%
                                            </div>
                                            <div className={`col-span-2 text-right pr-2 ${getHeatMapColor(p.mem, 'mem')}`}>
                                                {p.mem.toFixed(1)} MB
                                            </div>
                                            <div className={`col-span-1 text-right pr-2 ${getHeatMapColor(p.disk, 'disk')}`}>
                                                {p.disk.toFixed(1)} MB/s
                                            </div>
                                            <div className="col-span-1 text-right pr-2 text-gray-400">
                                                {p.net} Mbps
                                            </div>
                                        </div>
                                    ))}
                                    {processes.length === 0 && <div className="p-4 text-center text-gray-500">æ‰€æœ‰ä»»åŠ¡å·²ç»“æŸ</div>}
                                </div>

                                <div className="bg-[#2d2d2d] border-t border-gray-600 p-2 flex justify-between items-center h-10 mt-auto">
                                    <div className="text-gray-400 pl-2">
                                        è¿›ç¨‹æ•°: {processes.length}
                                    </div>
                                    <button 
                                        onClick={handleEndTask}
                                        disabled={!selectedId}
                                        className={`px-4 py-1 rounded border text-sm transition-colors ${
                                            selectedId 
                                            ? 'bg-[#3a3a3a] border-gray-500 text-white hover:bg-[#4a4a4a] active:bg-[#2a2a2a]' 
                                            : 'bg-[#2d2d2d] border-gray-600 text-gray-500 cursor-not-allowed'
                                        }`}
                                    >
                                        ç»“æŸä»»åŠ¡
                                    </button>
                                </div>
                            </div>
                        )}

                        {activeTab === 'performance' && (
                            <div className="h-full flex">
                                <div className="w-1/3 max-w-[200px] border-r border-gray-600 flex flex-col overflow-y-auto win-scroll bg-[#252525]">
                                    <PerfSidebarItem 
                                        title="CPU" subtitle="Intel Core i9-9900K" 
                                        value={perfType==='cpu' ? `${perfData[perfData.length-1].toFixed(0)}%` : (processes.some(p=>p.type==='stuck') ? "100%" : "12%")} 
                                        active={perfType === 'cpu'} onClick={() => setPerfType('cpu')} 
                                    />
                                    <PerfSidebarItem 
                                        title="å†…å­˜" subtitle="16.0 GB" 
                                        value={perfType==='mem' ? `${(perfData[perfData.length-1]/100 * 16).toFixed(1)} GB` : (processes.some(p=>p.type==='stuck') ? "9.2 GB" : "4.5 GB")} 
                                        active={perfType === 'mem'} onClick={() => setPerfType('mem')} 
                                    />
                                    <PerfSidebarItem 
                                        title="ç£ç›˜ 0 (C:)" subtitle="SSD" 
                                        value={perfType==='disk' ? `${perfData[perfData.length-1].toFixed(0)}%` : (processes.some(p=>p.type==='stuck') ? "50%" : "1%")} 
                                        active={perfType === 'disk'} onClick={() => setPerfType('disk')} 
                                    />
                                    <PerfSidebarItem 
                                        title="ä»¥å¤ªç½‘" subtitle="S: 0 R: 0 Kbps" 
                                        value="0%" 
                                        active={perfType === 'net'} onClick={() => setPerfType('net')} 
                                    />
                                </div>

                                <div className="flex-1 p-4 flex flex-col overflow-y-auto win-scroll">
                                    <div className="flex justify-between items-end mb-2">
                                        <span className="text-xl font-bold text-blue-400">
                                            {perfType === 'cpu' ? 'CPU' : perfType === 'mem' ? 'å†…å­˜' : perfType === 'disk' ? 'ç£ç›˜ 0 (C:)' : 'ä»¥å¤ªç½‘'}
                                        </span>
                                        <span className="text-base font-thin text-gray-300">
                                            {perfType === 'cpu' ? 'Intel Core i9-9900K @ 3.60GHz' : perfType === 'mem' ? '16.0 GB DDR4' : 'Samsung SSD 970 EVO Plus 1TB'}
                                        </span>
                                    </div>
                                    
                                    <div className="h-64 border border-gray-600 bg-[#1e1e1e] mb-6 relative p-px">
                                        <div className="absolute top-2 right-2 text-gray-400 text-xs">60 ç§’</div>
                                        <div className="absolute top-2 left-2 text-gray-400 text-xs">100%</div>
                                        <div className="absolute bottom-2 left-2 text-gray-400 text-xs">0%</div>
                                        <BigChart data={perfData} color={perfType === 'mem' ? '#a855f7' : '#60a5fa'} />
                                    </div>

                                    <div className="grid grid-cols-3 gap-x-8 gap-y-4 text-sm text-gray-400">
                                        {perfType === 'cpu' && (
                                            <>
                                                <div><div className="text-xs">åˆ©ç”¨ç‡</div><div className="text-xl text-white">{perfData[perfData.length-1].toFixed(0)}%</div></div>
                                                <div><div className="text-xs">é€Ÿåº¦</div><div className="text-xl text-white">4.20 GHz</div></div>
                                                <div><div className="text-xs">è¿›ç¨‹</div><div className="text-xl text-white">{processes.length + 180}</div></div>
                                                <div><div className="text-xs">çº¿ç¨‹</div><div className="text-xl text-white">2450</div></div>
                                                <div><div className="text-xs">å¥æŸ„</div><div className="text-xl text-white">89021</div></div>
                                                <div><div className="text-xs">æ­£å¸¸è¿è¡Œæ—¶é—´</div><div className="text-xl text-white">0:04:21:12</div></div>
                                                <div className="col-span-3 border-t border-gray-600 mt-2 pt-2 flex justify-between">
                                                    <span>åŸºå‡†é€Ÿåº¦: 3.60 GHz</span>
                                                    <span>å†…æ ¸: 8</span>
                                                    <span>é€»è¾‘å¤„ç†å™¨: 16</span>
                                                </div>
                                            </>
                                        )}
                                        {perfType === 'mem' && (
                                            <>
                                                <div><div className="text-xs">ä½¿ç”¨ä¸­</div><div className="text-xl text-white">{(perfData[perfData.length-1]/100 * 16).toFixed(1)} GB</div></div>
                                                <div><div className="text-xs">å¯ç”¨</div><div className="text-xl text-white">{(16 - perfData[perfData.length-1]/100 * 16).toFixed(1)} GB</div></div>
                                                <div><div className="text-xs">å·²æäº¤</div><div className="text-xl text-white">9.2/18.0 GB</div></div>
                                                <div><div className="text-xs">å·²ç¼“å­˜</div><div className="text-xl text-white">4.5 GB</div></div>
                                                <div><div className="text-xs">åˆ†é¡µç¼“å†²æ± </div><div className="text-xl text-white">482 MB</div></div>
                                                <div><div className="text-xs">éåˆ†é¡µç¼“å†²æ± </div><div className="text-xl text-white">390 MB</div></div>
                                                <div className="col-span-3 border-t border-gray-600 mt-2 pt-2">
                                                    é€Ÿåº¦: 3200 MHz &nbsp;&nbsp; æ’æ§½: 2/4 &nbsp;&nbsp; å¤–å½¢è§„æ ¼: DIMM
                                                </div>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'processes' && processes.some(p => p.type === 'stuck') && (
                            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-blue-600 text-white p-4 rounded-lg shadow-2xl animate-hint pointer-events-none z-20 border border-blue-400">
                                <div className="font-bold text-lg mb-1">â˜ï¸ è­¦æŠ¥ï¼šCPU 100%</div>
                                <div className="text-blue-100">
                                    å‘ç°çº¢è‰²é«˜äº®çš„ "CRASH_APP" äº†å—ï¼Ÿ<br/>
                                    é€‰ä¸­å®ƒï¼Œç„¶åç‚¹å‡»å³ä¸‹è§’çš„ [ç»“æŸä»»åŠ¡]ï¼
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- 5. ç¯å¢ƒå˜é‡ (æ¨¡æ‹ŸçœŸå®æ“ä½œ) ---
        const EnvVarSection = () => {
            const [terminalInput, setTerminalInput] = useState('');
            const [terminalOutput, setTerminalOutput] = useState([
                { text: "Windows PowerShell", type: 'info' },
                { text: "Copyright (C) Microsoft Corporation. All rights reserved.", type: 'info' },
                { text: "", type: 'empty' }
            ]);
            
            const [hasPython, setHasPython] = useState(false);
            const [selectedRow, setSelectedRow] = useState(null);
            const [showPathEditor, setShowPathEditor] = useState(false);
            const [pathList, setPathList] = useState([
                "C:\\Users\\Admin\\AppData\\Local\\Microsoft\\WindowsApps",
                "C:\\Users\\Admin\\AppData\\Local\\Programs\\Microsoft VS Code\\bin"
            ]);

            const userVars = [
                { name: "OneDrive", value: "C:\\Users\\Admin\\OneDrive" },
                { name: "Path", value: hasPython ? "C:\\Users\\Admin\\...;C:\\Python39\\bin" : "C:\\Users\\Admin\\AppData\\Local\\..." },
                { name: "TEMP", value: "C:\\Users\\Admin\\AppData\\Local\\Temp" },
                { name: "TMP", value: "C:\\Users\\Admin\\AppData\\Local\\Temp" }
            ];

            const sysVars = [
                { name: "ComSpec", value: "C:\\WINDOWS\\system32\\cmd.exe" },
                { name: "DriverData", value: "C:\\Windows\\System32\\Drivers\\DriverData" },
                { name: "OS", value: "Windows_NT" },
                { name: "Path", value: "C:\\WINDOWS\\system32;C:\\WINDOWS;..." },
                { name: "PROCESSOR_ARCHITECTURE", value: "AMD64" }
            ];

            const handleCommand = (e) => {
                if (e.key === 'Enter') {
                    const cmd = terminalInput.trim();
                    const newOutput = [...terminalOutput, { text: `PS C:\\Users\\Admin> ${cmd}`, type: 'command' }];
                    
                    if (cmd === 'python') {
                        if (hasPython) {
                            newOutput.push({ text: "Python 3.9.5 (tags/v3.9.5:0a7dcbd) [MSC v.1928 64 bit (AMD64)] on win32", type: 'success' });
                            newOutput.push({ text: "Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.", type: 'success' });
                            newOutput.push({ text: ">>> ", type: 'success' });
                        } else {
                            newOutput.push({ text: "python : æ— æ³•å°†â€œpythonâ€é¡¹è¯†åˆ«ä¸º cmdletã€å‡½æ•°ã€è„šæœ¬æ–‡ä»¶æˆ–å¯è¿è¡Œç¨‹åºçš„åç§°ã€‚", type: 'error' });
                            newOutput.push({ text: "è¯·æ£€æŸ¥åç§°çš„æ‹¼å†™ï¼Œå¦‚æœåŒ…æ‹¬è·¯å¾„ï¼Œè¯·ç¡®ä¿è·¯å¾„æ­£ç¡®ï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚", type: 'error' });
                        }
                    } else if (cmd === 'clear') {
                        setTerminalOutput([]);
                        setTerminalInput('');
                        return;
                    } else if (cmd !== '') {
                        newOutput.push({ text: `æ— æ³•è¯†åˆ«å‘½ä»¤ '${cmd}'`, type: 'error' });
                    }
                    
                    setTerminalOutput(newOutput);
                    setTerminalInput('');
                }
            };

            const addPythonToPath = () => {
                if (!pathList.includes("C:\\Python39\\bin")) {
                    setPathList([...pathList, "C:\\Python39\\bin"]);
                    setHasPython(true);
                }
            };

            return (
                <div className="h-full flex flex-col gap-6">
                    <div className="flex-1 bg-[#f0f0f0] rounded-lg shadow-xl border border-gray-400 text-black font-sans text-xs flex flex-col relative overflow-hidden select-none">
                        <div className="bg-white px-3 py-2 border-b border-gray-200 flex justify-between items-center">
                            <span>ç¯å¢ƒå˜é‡</span>
                            <div className="flex gap-2 text-gray-400">
                                <span>?</span>
                                <span>âœ•</span>
                            </div>
                        </div>

                        <div className="p-4 flex flex-col gap-4 overflow-y-auto win-scroll">
                            <div>
                                <div className="mb-1">Admin çš„ç”¨æˆ·å˜é‡(U)</div>
                                <div className="bg-white border border-gray-400 h-28 overflow-y-auto win-scroll">
                                    <table className="w-full text-left border-collapse">
                                        <thead>
                                            <tr className="bg-gray-100 border-b border-gray-300">
                                                <th className="font-normal w-1/3 pl-1 border-r border-gray-200">å˜é‡</th>
                                                <th className="font-normal pl-1">å€¼</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {userVars.map((v, i) => (
                                                <tr 
                                                    key={i} 
                                                    onClick={() => setSelectedRow(v.name)}
                                                    className={`cursor-default ${selectedRow === v.name ? 'bg-[#0078d7] text-white' : 'hover:bg-gray-100'}`}
                                                >
                                                    <td className="pl-1 border-r border-gray-200 border-dotted truncate max-w-[100px]">{v.name}</td>
                                                    <td className="pl-1 truncate max-w-[200px]">{v.value}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                                <div className="flex justify-end gap-2 mt-2">
                                    <button 
                                        onClick={() => {
                                            if (selectedRow === 'Path') setShowPathEditor(true);
                                            else alert("è¯·å…ˆé€‰ä¸­ 'Path' å˜é‡ï¼æˆ‘ä»¬éœ€è¦å‘Šè¯‰ç³»ç»Ÿå»å“ªé‡Œæ‰¾ç¨‹åºã€‚");
                                        }}
                                        className="px-3 py-1 border border-gray-400 bg-[#e1e1e1] hover:bg-[#e5f1fb] hover:border-[#0078d7] rounded-sm"
                                    >
                                        ç¼–è¾‘(E)...
                                    </button>
                                </div>
                            </div>

                            <div>
                                <div className="mb-1">ç³»ç»Ÿå˜é‡(S)</div>
                                <div className="bg-white border border-gray-400 h-28 overflow-y-auto opacity-70 win-scroll">
                                    <table className="w-full text-left border-collapse text-gray-600">
                                        <thead>
                                            <tr className="bg-gray-100 border-b border-gray-300">
                                                <th className="font-normal w-1/3 pl-1 border-r border-gray-200">å˜é‡</th>
                                                <th className="font-normal pl-1">å€¼</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {sysVars.map((v, i) => (
                                                <tr key={i}>
                                                    <td className="pl-1 border-r border-gray-200 border-dotted truncate max-w-[100px]">{v.name}</td>
                                                    <td className="pl-1 truncate max-w-[200px]">{v.value}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        {showPathEditor && (
                            <div className="absolute inset-0 bg-black/50 flex items-center justify-center z-50">
                                <div className="bg-white w-[90%] h-[90%] shadow-2xl border border-gray-500 flex flex-col text-xs">
                                    <div className="p-2 border-b flex justify-between items-center">
                                        <span>ç¼–è¾‘ç¯å¢ƒå˜é‡</span>
                                        <button onClick={() => setShowPathEditor(false)} className="hover:bg-red-500 hover:text-white px-2">âœ•</button>
                                    </div>
                                    <div className="flex-1 p-3 flex gap-3 overflow-hidden">
                                        <div className="flex-1 bg-white border border-gray-400 overflow-y-auto p-1 win-scroll">
                                            {pathList.map((path, i) => (
                                                <div key={i} className="hover:bg-[#e5f1fb] hover:border-[#0078d7] border border-transparent px-1 truncate">
                                                    {path}
                                                </div>
                                            ))}
                                        </div>
                                        <div className="flex flex-col gap-2 w-24">
                                            <button 
                                                onClick={addPythonToPath}
                                                className={`px-3 py-1 border border-gray-400 bg-[#e1e1e1] hover:bg-[#e5f1fb] hover:border-[#0078d7] rounded-sm text-left pl-2 ${hasPython ? 'opacity-50' : 'animate-pulse border-blue-500 font-bold'}`}
                                            >
                                                æ–°å»º(N)
                                            </button>
                                            <button className="px-3 py-1 border border-gray-400 bg-[#e1e1e1] rounded-sm text-left pl-2 opacity-50">ç¼–è¾‘(E)</button>
                                            <button className="px-3 py-1 border border-gray-400 bg-[#e1e1e1] rounded-sm text-left pl-2 opacity-50">åˆ é™¤(D)</button>
                                        </div>
                                    </div>
                                    <div className="p-2 border-t bg-[#f0f0f0] flex justify-end gap-2">
                                        <button onClick={() => setShowPathEditor(false)} className="px-4 py-1 border border-[#0078d7] bg-[#e1e1e1] hover:bg-[#e5f1fb] rounded-sm">ç¡®å®š</button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="h-48 bg-[#012456] text-gray-200 font-mono text-sm p-2 overflow-y-auto border-t-4 border-gray-600 rounded-b-lg shadow-inner win-scroll">
                        {terminalOutput.map((line, i) => (
                            <div key={i} className={`mb-1 break-all ${line.type === 'error' ? 'text-red-400' : line.type === 'success' ? 'text-green-300' : ''}`}>
                                {line.text}
                            </div>
                        ))}
                        <div className="flex">
                            <span className="text-white mr-2">PS C:\Users\Admin&gt;</span>
                            <input 
                                type="text" 
                                value={terminalInput}
                                onChange={(e) => setTerminalInput(e.target.value)}
                                onKeyDown={handleCommand}
                                className="bg-transparent border-none outline-none flex-1 text-white"
                                autoFocus
                                placeholder={hasPython ? "ç¯å¢ƒå·²é…ç½®ï¼è¾“å…¥ python è¯•è¯•" : "è¾“å…¥ python è¯•è¯•..."}
                            />
                        </div>
                    </div>
                </div>
            );
        };

        // --- ä¸»æ¡†æ¶ ---
        function App() {
            const [activeTab, setActiveTab] = useState('cmd');

            const MENU_ITEMS = [
                { id: 'cmd', icon: 'ğŸ’»', title: 'æ§åˆ¶å° (CMD/PS)', desc: 'çœŸæ­£çš„æƒåŠ›ä¸­å¿ƒ' },
                { id: 'file', icon: 'ğŸ—„ï¸', title: 'æ–‡ä»¶ç³»ç»Ÿ', desc: 'åˆ†åŒºã€æ ¼å¼åŒ–ä¸æ‰©å±•å' },
                { id: 'registry', icon: 'ğŸ§¬', title: 'æ³¨å†Œè¡¨', desc: 'ç³»ç»Ÿçš„ DNA' },
                { id: 'task', icon: 'ğŸ’“', title: 'ä»»åŠ¡ç®¡ç†å™¨', desc: 'éšå½¢çš„å·¥ä½œè€…' },
                { id: 'env', icon: 'ğŸ—ºï¸', title: 'ç¯å¢ƒå˜é‡', desc: 'ç³»ç»Ÿé€šè®¯å½•' },
            ];

            const renderContent = () => {
                switch(activeTab) {
                    case 'cmd': return <TerminalSection />;
                    case 'file': return <FileSystemSection />;
                    case 'registry': return <RegistrySection />;
                    case 'task': return <TaskManagerSection />;
                    case 'env': return <EnvVarSection />;
                    default: return <TerminalSection />;
                }
            };

            return (
                <div className="flex h-screen w-screen">
                    <div className="w-64 bg-slate-900 border-r border-slate-700 flex flex-col">
                        <div className="p-6 border-b border-slate-800">
                            <h1 className="text-xl font-bold text-white flex items-center gap-2">
                                <span className="text-cyan-400">WIN</span>
                                <span className="font-light">INTERNALS</span>
                            </h1>
                            <p className="text-xs text-slate-400 mt-1">è¿›é˜¶æŒ‡å— v2.5</p>
                        </div>
                        <nav className="flex-1 p-4 space-y-2">
                            {MENU_ITEMS.map(item => (
                                <button
                                    key={item.id}
                                    onClick={() => setActiveTab(item.id)}
                                    className={`nav-item w-full text-left p-3 rounded transition-all duration-200 group ${activeTab === item.id ? 'active' : 'text-slate-400 hover:text-white hover:bg-slate-800'}`}
                                >
                                    <div className="flex items-center gap-3">
                                        <span className="text-xl group-hover:scale-110 transition-transform">{item.icon}</span>
                                        <div>
                                            <div className="font-bold text-sm">{item.title}</div>
                                            <div className="text-[10px] opacity-70">{item.desc}</div>
                                        </div>
                                    </div>
                                </button>
                            ))}
                        </nav>
                        
                        <div className="p-4 m-4 bg-gradient-to-br from-indigo-900 to-slate-900 rounded border border-indigo-500/30 text-xs">
                            <div className="font-bold text-indigo-300 mb-1">ğŸ’¡ è¿›é˜¶è£…é€¼æŠ€å·§</div>
                            <div className="text-slate-300 leading-relaxed">
                                {activeTab === 'cmd' && "æŒ‰ä½ Shift + å³é”®ç‚¹å‡»æ–‡ä»¶å¤¹èƒŒæ™¯ï¼Œå¯ä»¥é€‰æ‹©â€œåœ¨æ­¤å¤„æ‰“å¼€ PowerShell çª—å£â€ã€‚"}
                                {activeTab === 'file' && "å°è¯•åœ¨åœ°å€æ è¾“å…¥ 'cmd' ç„¶åå›è½¦ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªç›®å½•æ‰“å¼€ç»ˆç«¯ã€‚"}
                                {activeTab === 'registry' && "æ°¸è¿œä¸è¦åœ¨æ²¡æœ‰å¤‡ä»½çš„æƒ…å†µä¸‹åˆ é™¤æ³¨å†Œè¡¨é”®å€¼ã€‚å¯ä»¥ä½¿ç”¨ 'å¯¼å‡º' åŠŸèƒ½å¤‡ä»½ã€‚"}
                                {activeTab === 'task' && "æŒ‰ Ctrl + Shift + Esc å¯ä»¥ç›´æ¥è°ƒå‡ºä»»åŠ¡ç®¡ç†å™¨ï¼Œæ¯” Ctrl+Alt+Del æ›´å¿«ã€‚"}
                                {activeTab === 'env' && "ä¿®æ”¹ç¯å¢ƒå˜é‡åï¼Œé€šå¸¸éœ€è¦é‡å¯ç»ˆç«¯ï¼ˆCMD/PSï¼‰æ‰ä¼šç”Ÿæ•ˆã€‚"}
                            </div>
                        </div>
                    </div>

                    <div className="flex-1 flex flex-col bg-[#0f172a] relative overflow-hidden">
                        <div className="absolute inset-0 z-0 opacity-10 pointer-events-none" 
                             style={{backgroundImage: 'radial-gradient(#475569 1px, transparent 1px)', backgroundSize: '20px 20px'}}>
                        </div>

                        <div className="p-8 pb-4 z-10">
                            <h2 className="text-3xl font-bold text-white mb-2">
                                {MENU_ITEMS.find(i => i.id === activeTab).title}
                            </h2>
                            <p className="text-slate-400">
                                {activeTab === 'cmd' && "å›¾å½¢ç•Œé¢é™åˆ¶äº†ä½ çš„æƒ³è±¡åŠ›ï¼Œå‘½ä»¤è¡Œæ‰æ˜¯çœŸæ­£çš„â€œä¸Šå¸æ¨¡å¼â€ã€‚"}
                                {activeTab === 'file' && "æ–‡ä»¶ç³»ç»Ÿä¸ä»…æ˜¯ä»“åº“ï¼Œæ›´æ˜¯æœ‰ç€æ£®ä¸¥ç­‰çº§åˆ¶åº¦çš„é€»è¾‘åˆ†åŒºã€‚"}
                                {activeTab === 'registry' && "Windows çš„åŸºå› åº“ã€‚æ‰€æœ‰çš„è®¾ç½®å˜åŠ¨ï¼Œæœ€ç»ˆéƒ½ä¼šå†™åœ¨è¿™é‡Œã€‚"}
                                {activeTab === 'task' && "å½“ç”µè„‘å¡æ­»æ—¶ï¼Œè¿™é‡Œå°±æ˜¯ä½ çš„æ‰‹æœ¯å°ã€‚æ‰¾åˆ°ç—…ç¶ï¼Œåˆ‡é™¤å®ƒã€‚"}
                                {activeTab === 'env' && "ä¸ºä»€ä¹ˆè¾“å…¥ python ç”µè„‘å°±çŸ¥é“å»å“ªé‡Œæ‰¾ç¨‹åºï¼Ÿå…¨é è¿™ä¸ªâ€œé€šè®¯å½•â€ã€‚"}
                            </p>
                        </div>

                        <div className="flex-1 p-8 pt-0 z-10 overflow-hidden">
                            <div className="h-full bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 shadow-2xl overflow-y-auto">
                                {renderContent()}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>